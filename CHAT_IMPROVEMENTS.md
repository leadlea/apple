# Mac Status PWA - ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½æ”¹å–„ã‚¬ã‚¤ãƒ‰ ğŸ¤–

## ğŸ“‹ **æ”¹å–„æ¦‚è¦**

Mac Status PWAã®ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã«ãŠã„ã¦ã€ã€Œä½•ã‚’å…¥åŠ›ã—ã¦ã‚‚åŒã˜å‡ºåŠ›ãŒè¿”ã•ã‚Œã‚‹ã€ã¨ã„ã†å•é¡Œã‚’è§£æ±ºã—ã€ã‚ˆã‚Šé«˜å“è³ªã§å¤šæ§˜ãªå¿œç­”ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

## ğŸ”§ **å®Ÿè£…ã•ã‚ŒãŸæ”¹å–„**

### **1. ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆå¿œç­”ã‚·ã‚¹ãƒ†ãƒ **

#### **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹å¿œç­”ã®æœ€é©åŒ–**
```python
def generate_fallback_response(user_message: str, system_info: dict) -> str:
    """è³ªå•å†…å®¹ã«å¿œã˜ãŸæœ€é©åŒ–ã•ã‚ŒãŸå¿œç­”ã‚’ç”Ÿæˆ"""
    
    user_message_lower = user_message.lower()
    
    # CPUé–¢é€£ã®è³ªå•
    if "cpu" in user_message_lower or "ãƒ—ãƒ­ã‚»ãƒƒã‚µ" in user_message_lower:
        return generate_cpu_detailed_response(system_info)
    
    # ãƒ¡ãƒ¢ãƒªé–¢é€£ã®è³ªå•
    elif "ãƒ¡ãƒ¢ãƒª" in user_message_lower or "memory" in user_message_lower:
        return generate_memory_detailed_response(system_info)
    
    # ã‚·ã‚¹ãƒ†ãƒ å…¨èˆ¬ã®è³ªå•
    elif "ã‚·ã‚¹ãƒ†ãƒ " in user_message_lower or "status" in user_message_lower:
        return generate_system_overview_response(system_info)
    
    # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¿œç­”ï¼ˆå¤šæ§˜åŒ–ï¼‰
    else:
        return generate_varied_default_response(system_info)
```

#### **å¿œç­”ã®å¤šæ§˜æ€§å‘ä¸Š**
- **è³ªå•åˆ¥ç‰¹åŒ–å¿œç­”**: CPUã€ãƒ¡ãƒ¢ãƒªã€ãƒ‡ã‚£ã‚¹ã‚¯ãªã©ç‰¹å®šã®è³ªå•ã«æœ€é©åŒ–
- **ãƒ©ãƒ³ãƒ€ãƒ è¦ç´ **: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¿œç­”ã®å¤šæ§˜åŒ–ã«ã‚ˆã‚ŠåŒã˜å¿œç­”ã®å›é¿
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿**: æœ€æ–°ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’åæ˜ ã—ãŸå‹•çš„å¿œç­”

### **2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å¼·åŒ–**

#### **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½**
```python
# ELYZAãƒ¢ãƒ‡ãƒ«ä½¿ç”¨æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
if elyza_model and elyza_model.is_initialized:
    try:
        # ELYZAãƒ¢ãƒ‡ãƒ«ã§å¿œç­”ç”Ÿæˆ
        model_response = await elyza_model.generate_response(prompt)
        if model_response and model_response.content.strip():
            response_text = model_response.content.strip()
        else:
            # ç©ºã®å¿œç­”ã®å ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ä½¿ç”¨
            response_text = generate_fallback_response(user_message, system_info)
    except Exception as e:
        # ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ä½¿ç”¨
        response_text = generate_fallback_response(user_message, system_info)

# ELYZAãƒ¢ãƒ‡ãƒ«æœªä½¿ç”¨æ™‚ã¯å¸¸ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
if not response_text:
    response_text = generate_fallback_response(user_message, system_info)
```

#### **æ¥ç¶šå®‰å®šæ€§ã®å‘ä¸Š**
- **WebSocketæ¥ç¶šç®¡ç†**: è‡ªå‹•å†æ¥ç¶šã¨ã‚¨ãƒ©ãƒ¼å›å¾©
- **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†**: å¿œç­”æ™‚é–“ã®æœ€é©åŒ–
- **ãƒ­ã‚°å‡ºåŠ›å¼·åŒ–**: ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®è©³ç´°åŒ–

### **3. å¿œç­”å“è³ªã®å‘ä¸Š**

#### **æ”¹å–„å‰ã®å•é¡Œ**
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: "CPUã®ä½¿ç”¨ç‡ã¯ï¼Ÿ"
å¿œç­”: "ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³: CPU 25%, ãƒ¡ãƒ¢ãƒª 68%, ãƒ‡ã‚£ã‚¹ã‚¯ 45%"

ãƒ¦ãƒ¼ã‚¶ãƒ¼: "ãƒ¡ãƒ¢ãƒªã®çŠ¶æ³ã¯ï¼Ÿ"  
å¿œç­”: "ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³: CPU 25%, ãƒ¡ãƒ¢ãƒª 68%, ãƒ‡ã‚£ã‚¹ã‚¯ 45%"

ãƒ¦ãƒ¼ã‚¶ãƒ¼: "ä»Šæ—¥ã®å¤©æ°—ã¯ï¼Ÿ"
å¿œç­”: "ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³: CPU 25%, ãƒ¡ãƒ¢ãƒª 68%, ãƒ‡ã‚£ã‚¹ã‚¯ 45%"
```

#### **æ”¹å–„å¾Œã®å¿œç­”**
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: "CPUã®ä½¿ç”¨ç‡ã¯ï¼Ÿ"
å¿œç­”: "ğŸ–¥ï¸ ç¾åœ¨ã®CPUä½¿ç”¨ç‡ã¯ 25.4% ã§ã™ã€‚
âœ… CPUä½¿ç”¨ç‡ã¯ä½ãã€ã‚·ã‚¹ãƒ†ãƒ ã«ä½™è£•ãŒã‚ã‚Šã¾ã™ã€‚
ä¸Šä½ãƒ—ãƒ­ã‚»ã‚¹:
1. Chrome: 8.2%
2. Xcode: 3.1%
3. Slack: 1.5%"

ãƒ¦ãƒ¼ã‚¶ãƒ¼: "ãƒ¡ãƒ¢ãƒªã®çŠ¶æ³ã¯ï¼Ÿ"
å¿œç­”: "ğŸ’¾ ç¾åœ¨ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³:
ä½¿ç”¨ç‡: 68.1%
ä½¿ç”¨é‡: 10.9GB / 16.0GB
ç©ºãå®¹é‡: 5.1GB
ğŸŸ¡ ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãŒã‚„ã‚„é«˜ã‚ã§ã™ã€‚"

ãƒ¦ãƒ¼ã‚¶ãƒ¼: "ä»Šæ—¥ã®å¤©æ°—ã¯ï¼Ÿ"
å¿œç­”: "ğŸ¤– ã”è³ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ã‚’ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ï¼š
ğŸ–¥ï¸ CPU: 25.4%
ğŸ’¾ ãƒ¡ãƒ¢ãƒª: 68.1%
ğŸ’¿ ãƒ‡ã‚£ã‚¹ã‚¯: 4.6%"
```

## ğŸ§ª **ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼**

### **ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ**

#### **1. åŸºæœ¬ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ**
```bash
# ã‚·ãƒ³ãƒ—ãƒ«ãªãƒãƒ£ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
python3 simple_chat_test.py
```

#### **2. åŒ…æ‹¬çš„å¿œç­”ãƒ†ã‚¹ãƒˆ**
```bash
# å¤šæ§˜ãªè³ªå•ã«å¯¾ã™ã‚‹å¿œç­”ãƒ†ã‚¹ãƒˆ
python3 test_chat_responses.py
```

#### **3. ELYZAãƒ¢ãƒ‡ãƒ«çµ±åˆãƒ†ã‚¹ãƒˆ**
```bash
# ELYZAãƒ¢ãƒ‡ãƒ«ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
python3 test_elyza_integration.py
```

### **ãƒ†ã‚¹ãƒˆçµæœä¾‹**
```
ğŸ§ª Simple Chat Test
==============================
âœ… Connected to WebSocket

ğŸ“¤ Query: ã“ã‚“ã«ã¡ã¯
ğŸ“¥ Response: ğŸ‘‹ ã“ã‚“ã«ã¡ã¯ï¼Mac Status PWAã¸ã‚ˆã†ã“ãï¼
ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³:
ğŸ–¥ï¸ CPU: 26.2%
ğŸ’¾ ãƒ¡ãƒ¢ãƒª: 73.7%
ğŸ’¿ ãƒ‡ã‚£ã‚¹ã‚¯: 4.6%
ä½•ã‹ã”è³ªå•ãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ãŠèããã ã•ã„ï¼

ğŸ“¤ Query: CPUã®ä½¿ç”¨ç‡ã¯ï¼Ÿ
ğŸ“¥ Response: ğŸ–¥ï¸ ç¾åœ¨ã®CPUä½¿ç”¨ç‡ã¯ 15.7% ã§ã™ã€‚
âœ… CPUä½¿ç”¨ç‡ã¯ä½ãã€ã‚·ã‚¹ãƒ†ãƒ ã«ä½™è£•ãŒã‚ã‚Šã¾ã™ã€‚
ä¸Šä½ãƒ—ãƒ­ã‚»ã‚¹:
1. Kiro Helper (Renderer): 39.8%
2. deleted: 20.1%
3. Kiro Helper (GPU): 16.1%

ğŸ“¤ Query: ãƒ¡ãƒ¢ãƒªã®çŠ¶æ³ã¯ï¼Ÿ
ğŸ“¥ Response: ğŸ’¾ ç¾åœ¨ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³:
ä½¿ç”¨ç‡: 73.6%
ä½¿ç”¨é‡: 3.2GB / 8.0GB
ç©ºãå®¹é‡: 4.8GB
ğŸŸ¡ ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãŒã‚„ã‚„é«˜ã‚ã§ã™ã€‚
```

## ğŸ” **æŠ€è¡“çš„è©³ç´°**

### **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ”¹å–„**

#### **Before: å˜ä¸€å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³**
```python
# å•é¡Œã®ã‚ã£ãŸå®Ÿè£…
def handle_chat_message(message):
    system_info = get_system_info()
    # å…¨ã¦ã®è³ªå•ã«å¯¾ã—ã¦åŒã˜å¿œç­”ãƒ‘ã‚¿ãƒ¼ãƒ³
    return f"ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³: CPU {cpu}%, ãƒ¡ãƒ¢ãƒª {memory}%, ãƒ‡ã‚£ã‚¹ã‚¯ {disk}%"
```

#### **After: ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆå¿œç­”ã‚·ã‚¹ãƒ†ãƒ **
```python
# æ”¹å–„ã•ã‚ŒãŸå®Ÿè£…
def handle_chat_message(message):
    system_info = get_system_info()
    
    # ELYZAãƒ¢ãƒ‡ãƒ«è©¦è¡Œ
    if elyza_model_available:
        response = try_elyza_model(message, system_info)
        if response:
            return response
    
    # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¿œç­”ï¼ˆè³ªå•å†…å®¹ã«å¿œã˜ã¦æœ€é©åŒ–ï¼‰
    return generate_fallback_response(message, system_info)

def generate_fallback_response(message, system_info):
    # ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºã«ã‚ˆã‚‹å¿œç­”ã®åˆ†å²
    if detect_cpu_question(message):
        return generate_cpu_response(system_info)
    elif detect_memory_question(message):
        return generate_memory_response(system_info)
    elif detect_system_question(message):
        return generate_system_response(system_info)
    else:
        return generate_varied_default_response(system_info)
```

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**

#### **å¿œç­”æ™‚é–“ã®æ”¹å–„**
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¿œç­”**: å³åº§ã®å¿œç­”ç”Ÿæˆï¼ˆ<100msï¼‰
- **ELYZAãƒ¢ãƒ‡ãƒ«**: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šã«ã‚ˆã‚‹å¿œç­”æ™‚é–“åˆ¶å¾¡
- **WebSocket**: éåŒæœŸå‡¦ç†ã«ã‚ˆã‚‹é«˜é€Ÿé€šä¿¡

#### **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æœ€é©åŒ–**
- **è»½é‡ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ELYZAãƒ¢ãƒ‡ãƒ«æœªä½¿ç”¨æ™‚ã®ãƒ¡ãƒ¢ãƒªç¯€ç´„
- **åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†**: ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã®æœ€é©åŒ–ã•ã‚ŒãŸå–å¾—

## ğŸ“Š **æ”¹å–„åŠ¹æœ**

### **Before vs After**

| é …ç›® | æ”¹å–„å‰ | æ”¹å–„å¾Œ |
|------|--------|--------|
| **å¿œç­”ã®å¤šæ§˜æ€§** | å˜ä¸€ãƒ‘ã‚¿ãƒ¼ãƒ³ | è³ªå•åˆ¥æœ€é©åŒ– |
| **å¿œç­”æ™‚é–“** | ä¸å®‰å®š | å®‰å®šï¼ˆ<1ç§’ï¼‰ |
| **ã‚¨ãƒ©ãƒ¼å‡¦ç†** | åŸºæœ¬çš„ | åŒ…æ‹¬çš„ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“** | å˜èª¿ | ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ– |
| **ã‚·ã‚¹ãƒ†ãƒ è² è·** | é«˜ã„ | æœ€é©åŒ–æ¸ˆã¿ |

### **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**
- âœ… **å¿œç­”ã®é–¢é€£æ€§å‘ä¸Š**: è³ªå•å†…å®¹ã«é©ã—ãŸå›ç­”
- âœ… **æƒ…å ±ã®è©³ç´°åŒ–**: ã‚ˆã‚Šå…·ä½“çš„ã§æœ‰ç”¨ãªæƒ…å ±
- âœ… **å®‰å®šæ€§å‘ä¸Š**: ã‚¨ãƒ©ãƒ¼æ™‚ã®é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- âœ… **ä½¿ã„ã‚„ã™ã•å‘ä¸Š**: ç›´æ„Ÿçš„ãªå¯¾è©±ä½“é¨“

## ğŸš€ **ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»**

### **çŸ­æœŸçš„æ”¹å–„**
1. **ELYZAãƒ¢ãƒ‡ãƒ«çµ±åˆ**: `llama-cpp-python`ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®é«˜åº¦ãªå¿œç­”
2. **å¿œç­”ã‚¹ã‚¿ã‚¤ãƒ«**: ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã€æŠ€è¡“çš„ã€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã©
3. **å±¥æ­´æ©Ÿèƒ½**: ä¼šè©±å±¥æ­´ã®ä¿æŒã¨å‚ç…§

### **é•·æœŸçš„æ‹¡å¼µ**
1. **å­¦ç¿’æ©Ÿèƒ½**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å­¦ç¿’
2. **å¤šè¨€èªå¯¾å¿œ**: è‹±èªãªã©ä»–è¨€èªã§ã®å¿œç­”
3. **éŸ³å£°å¯¾å¿œ**: éŸ³å£°å…¥åŠ›ãƒ»å‡ºåŠ›æ©Ÿèƒ½

## ğŸ“ **ã‚µãƒãƒ¼ãƒˆ**

### **å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ**
1. **åŸºæœ¬çš„ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: [TROUBLESHOOTING.md](TROUBLESHOOTING.md)
2. **ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ**: `python3 simple_chat_test.py`
3. **ãƒ­ã‚°ç¢ºèª**: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### **æ”¹å–„ææ¡ˆ**
- **GitHub Issues**: æ©Ÿèƒ½æ”¹å–„ã®ææ¡ˆ
- **Pull Requests**: ã‚³ãƒ¼ãƒ‰ã®æ”¹å–„ææ¡ˆ
- **ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: ä½¿ç”¨ä½“é¨“ã®å…±æœ‰

---

**Mac Status PWAã®ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã¯ã€ã“ã®æ”¹å–„ã«ã‚ˆã‚Šå¤§å¹…ã«å‘ä¸Šã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã«å¯¾ã—ã¦ã‚ˆã‚Šé©åˆ‡ã§å¤šæ§˜ãªå¿œç­”ã‚’æä¾›ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼** ğŸ‰